(function(){var m={h:{g:{"sky-sun":function(a){if(256===a)return[255,255,255];a=Math.abs(2*a-255)%256;return[a,a,256-a>>1]},bw:function(a){if(256===a)return[255,255,255];a=Math.abs(2*a-255)%256;return[a,a,a]},"sky-sun-2":function(a){if(256===a)return[0,0,127];a=Math.abs(a-255)%256;return[a,a,256-a>>1]},"bw-2":function(a){if(256===a)return[0,0,0];a=Math.abs(a-255)%256;return[a,a,a]},green:function(a){if(256===a)return[255,255,255];a=Math.abs(2*a-255)%256;return[a>>1,a,a>>1]}}}};m.h&&(m=m.h);var p={h:{constructor:function(a,c){this.g=a;c.call(this);this.o=$('<div class="bar"/>');this.o.on("click","canvas",function(a){a=$(a.target).data("id");this.trigger("change",a)}.bind(this));for(var b in this.g){var d=n(this.g[b]);$(d).data("id",b).appendTo(this.o)}}}};function n(a){var c=document.createElement("canvas"),b=c.getContext("2d");c.width=32;c.height=32;for(var d=0;32>d;++d){var e=a(8*d);b.fillStyle="rgb("+e[0]+","+e[1]+","+e[2]+")";b.fillRect(0,d,32,d)}return c}p.h&&(p=p.h);var s=p,t=m,u;function v(a,c){for(var b=a,d=c,e,h,f=1;256>f&&4>=(e=a*a)+(h=c*c);++f)c=2*a*c+d,a=e-h+b;return f}
x({constructor:function(a,c){s=c(s);this.$=a.addClass("fractal");this.l=this.l.bind(this);this.m=this.m.bind(this);this.c=this.c.bind(this);this.n=this.n.bind(this);this.f=this.f.bind(this);this.q=this.q.bind(this);this.v=$('<canvas class="fr"></canvas>').appendTo(a).on("mousedown",this.I.bind(this)).on("mousewheel DOMMouseScroll",this.J.bind(this));this.p=this.v[0];this.r=this.p.getContext("2d");var b=$('<div class="msg">Drag to pan, scroll to zoom</div>').appendTo(this.$);setTimeout(function(){b.addClass("min")},
1E3);$(window).one("mousedown",function(){b.remove()});var d=new s(t.g,c.E);d.o.appendTo(this.$);d.on("change",function(a){this.u(a);this.c()},this);this.sb=["home","share",$('<a class="btn fa fa-arrows-alt" title="Toggle Full Screen"></a>').on("click",function(){this.F();this.c()}.bind(this))]},H:function(){$(window).on("mousemove",this.l).on("mouseup",this.m)},J:function(a){u||(u=this.v.offset());a=a.originalEvent;var c=Math.max(-0.999,0.001*-a.wheelDelta||0.05*a.detail),b=((a.clientY-u.top)/this.height-
0.5)*this.b;this.d-=((a.clientX-u.left)/this.width-0.5)*this.a*c;this.e-=b*c;this.a*=c+1;this.b*=c+1;clearTimeout(this.L);this.n();this.L=setTimeout(this.c,100);return!1},M:function(){$(window).off("mousemove",this.l).off("mouseup",this.m)},I:function(a){this.t=!0;this.A=a.pageX;this.B=a.pageY},l:function(a){this.t&&(this.d+=(this.A-a.pageX)/this.width*this.a,this.e+=(this.B-a.pageY)/this.height*this.b,this.A=a.pageX,this.B=a.pageY,this.n())},m:function(){this.t&&(this.t=!1,this.c())},title:"Fractal",
i:function(){this.w||(this.w=!0,this.H());this.G()},s:function(){this.w=!1;this.M()},c:function(){for(var a=this.a/this.width,c=this.b/this.height,b=this.j.data,d=this.d-this.a/2,e=0;e<this.width;e++,d+=a)for(var h=this.e-this.b/2,f=0;f<this.height;f++,h+=c){var k=this.D(v(d,h)),g=e+f*this.width<<2;b[g]=k[0];b[g+1]=k[1];b[g+2]=k[2];b[g+3]=255}this.r.putImageData(this.j,0,0);setTimeout(this.q,100)},n:function(){for(var a=this.a/this.width*2,c=this.b/this.height*2,b=this.j.data,d=this.d-this.a/2,e=
0;e<this.width;e+=2,d+=a)for(var h=this.e-this.b/2,f=0;f<this.height;f+=2,h+=c){var k=this.D(v(d,h)),g=e+f*this.width<<2,q=g+4,l=g+4*this.width,r=l+4;b[g]=b[q]=b[l]=b[r]=k[0];b[g+1]=b[q+1]=b[l+1]=b[r+1]=k[1];b[g+2]=b[q+2]=b[l+2]=b[r+2]=k[2];b[g+3]=b[q+3]=b[l+3]=b[r+3]=255}this.r.putImageData(this.j,0,0)},F:function(a){(this.k="boolean"===typeof a?a:!this.k)?(this.f(),this.$.addClass("fs"),$(window).on("resize",this.f)):(this.f(512,256),this.$.removeClass("fs"),$(window).off("resize",this.f))},f:function(a,
c){this.p.width=this.width="number"===typeof a?a:window.innerWidth;this.p.height=this.height="number"===typeof c?c:window.innerHeight;this.b=this.a/this.width*this.height;this.j=this.r.createImageData(this.width,this.height)},u:function(a){var c=t.g[a];if("undefined"===typeof c)for(var b in t.g){this.u(b);return}this.K=a;this.D=c},C:function(){return this.d+","+this.e+","+this.a+","+this.K+(this.k?",fs":"")},q:function(){location.replace("#/fractal/"+this.C())},G:function(){var a=location.hash.replace("#/fractal/",
"");a!==this.C()&&(a=a.split(","),this.d=isNaN(a[0])?-0.43:+a[0],this.e=isNaN(a[1])?-0.595:+a[1],this.a=isNaN(a[2])?0.1:+a[2],this.b=this.a/this.width*this.height,this.u(a[3]),a="fs"===a[a.length-1],a!==this.k&&this.F(a),this.c())}});})();
